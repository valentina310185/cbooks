/* ================================================
 * Make use of Bootstrap's modal more monkey-friendly.
 * 
 * For Bootstrap 3.
 * 
 * javanoob@hotmail.com
 * 
 * https://github.com/nakupanda/bootstrap3-dialog
 * 
 * Licensed under The MIT License.
 * ================================================ 
 */
(function(e,t){"use strict";if(typeof module!=="undefined"&&module.exports){module.exports=t(require("jquery")(e))}else if(typeof define==="function"&&define.amd){define("bootstrap-dialog",["jquery"],function(e){return t(e)})}else{e.BootstrapDialog=t(e.jQuery)}})(this,function(e){"use strict";var t=function(n){this.defaultOptions=e.extend(true,{id:t.newGuid(),buttons:[],data:{},onshow:null,onshown:null,onhide:null,onhidden:null},t.defaultOptions);this.indexedButtons={};this.registeredButtonHotkeys={};this.draggableData={isMouseDown:false,mouseOffset:{}};this.realized=false;this.opened=false;this.initOptions(n);this.holdThisInstance()};t.NAMESPACE="bootstrap-dialog";t.TYPE_DEFAULT="type-default";t.TYPE_INFO="type-info";t.TYPE_PRIMARY="type-primary";t.TYPE_SUCCESS="type-success";t.TYPE_WARNING="type-warning";t.TYPE_DANGER="type-danger";t.DEFAULT_TEXTS={};t.DEFAULT_TEXTS[t.TYPE_DEFAULT]="Information";t.DEFAULT_TEXTS[t.TYPE_INFO]="Information";t.DEFAULT_TEXTS[t.TYPE_PRIMARY]="Information";t.DEFAULT_TEXTS[t.TYPE_SUCCESS]="Success";t.DEFAULT_TEXTS[t.TYPE_WARNING]="Warning";t.DEFAULT_TEXTS[t.TYPE_DANGER]="Danger";t.SIZE_NORMAL="size-normal";t.SIZE_LARGE="size-large";t.BUTTON_SIZES={};t.BUTTON_SIZES[t.SIZE_NORMAL]="";t.BUTTON_SIZES[t.SIZE_LARGE]="btn-lg";t.ICON_SPINNER="glyphicon glyphicon-asterisk";t.ZINDEX_BACKDROP=1040;t.ZINDEX_MODAL=1050;t.defaultOptions={type:t.TYPE_PRIMARY,size:t.SIZE_NORMAL,cssClass:"",title:null,message:null,nl2br:true,closable:true,closeByBackdrop:true,closeByKeyboard:true,spinicon:t.ICON_SPINNER,autodestroy:true,draggable:false,animate:true,description:""};t.configDefaultOptions=function(n){t.defaultOptions=e.extend(true,t.defaultOptions,n)};t.dialogs={};t.openAll=function(){e.each(t.dialogs,function(e,t){t.open()})};t.closeAll=function(){e.each(t.dialogs,function(e,t){t.close()})};t.moveFocus=function(){var n=null;e.each(t.dialogs,function(e,t){n=t});if(n!==null&&n.isRealized()){n.getModal().focus()}};t.showScrollbar=function(){var n=null;e.each(t.dialogs,function(e,t){n=t});if(n!==null&&n.isRealized()&&n.isOpened()){var r=n.getModal().data("bs.modal");r.checkScrollbar();e("body").addClass("modal-open");r.setScrollbar()}};t.prototype={constructor:t,initOptions:function(t){this.options=e.extend(true,this.defaultOptions,t);return this},holdThisInstance:function(){t.dialogs[this.getId()]=this;return this},initModalStuff:function(){this.setModal(this.createModal()).setModalDialog(this.createModalDialog()).setModalContent(this.createModalContent()).setModalHeader(this.createModalHeader()).setModalBody(this.createModalBody()).setModalFooter(this.createModalFooter());this.getModal().append(this.getModalDialog());this.getModalDialog().append(this.getModalContent());this.getModalContent().append(this.getModalHeader()).append(this.getModalBody()).append(this.getModalFooter());return this},createModal:function(){var t=e('<div class="modal" tabindex="-1" role="dialog" aria-hidden="true"></div>');t.prop("id",this.getId()).attr("aria-labelledby",this.getId()+"_title");return t},getModal:function(){return this.$modal},setModal:function(e){this.$modal=e;return this},createModalDialog:function(){return e('<div class="modal-dialog"></div>')},getModalDialog:function(){return this.$modalDialog},setModalDialog:function(e){this.$modalDialog=e;return this},createModalContent:function(){return e('<div class="modal-content"></div>')},getModalContent:function(){return this.$modalContent},setModalContent:function(e){this.$modalContent=e;return this},createModalHeader:function(){return e('<div class="modal-header"></div>')},getModalHeader:function(){return this.$modalHeader},setModalHeader:function(e){this.$modalHeader=e;return this},createModalBody:function(){return e('<div class="modal-body"></div>')},getModalBody:function(){return this.$modalBody},setModalBody:function(e){this.$modalBody=e;return this},createModalFooter:function(){return e('<div class="modal-footer"></div>')},getModalFooter:function(){return this.$modalFooter},setModalFooter:function(e){this.$modalFooter=e;return this},createDynamicContent:function(e){var t=null;if(typeof e==="function"){t=e.call(e,this)}else{t=e}if(typeof t==="string"){t=this.formatStringContent(t)}return t},formatStringContent:function(e){if(this.options.nl2br){return e.replace(/\r\n/g,"<br />").replace(/[\r\n]/g,"<br />")}return e},setData:function(e,t){this.options.data[e]=t;return this},getData:function(e){return this.options.data[e]},setId:function(e){this.options.id=e;return this},getId:function(){return this.options.id},getType:function(){return this.options.type},setType:function(e){this.options.type=e;this.updateType();return this},updateType:function(){if(this.isRealized()){var e=[t.TYPE_DEFAULT,t.TYPE_INFO,t.TYPE_PRIMARY,t.TYPE_SUCCESS,t.TYPE_WARNING,t.TYPE_DANGER];this.getModal().removeClass(e.join(" ")).addClass(this.getType())}return this},getSize:function(){return this.options.size},setSize:function(e){this.options.size=e;return this},getCssClass:function(){return this.options.cssClass},setCssClass:function(e){this.options.cssClass=e;return this},getTitle:function(){return this.options.title},setTitle:function(e){this.options.title=e;this.updateTitle();return this},updateTitle:function(){if(this.isRealized()){var e=this.getTitle()!==null?this.createDynamicContent(this.getTitle()):this.getDefaultText();this.getModalHeader().find("."+this.getNamespace("title")).html("").append(e).prop("id",this.getId()+"_title")}return this},getMessage:function(){return this.options.message},setMessage:function(e){this.options.message=e;this.updateMessage();return this},updateMessage:function(){if(this.isRealized()){var e=this.createDynamicContent(this.getMessage());this.getModalBody().find("."+this.getNamespace("message")).html("").append(e)}return this},isClosable:function(){return this.options.closable},setClosable:function(e){this.options.closable=e;this.updateClosable();return this},setCloseByBackdrop:function(e){this.options.closeByBackdrop=e;return this},canCloseByBackdrop:function(){return this.options.closeByBackdrop},setCloseByKeyboard:function(e){this.options.closeByKeyboard=e;return this},canCloseByKeyboard:function(){return this.options.closeByKeyboard},isAnimate:function(){return this.options.animate},setAnimate:function(e){this.options.animate=e;return this},updateAnimate:function(){if(this.isRealized()){this.getModal().toggleClass("fade",this.isAnimate())}return this},getSpinicon:function(){return this.options.spinicon},setSpinicon:function(e){this.options.spinicon=e;return this},addButton:function(e){this.options.buttons.push(e);return this},addButtons:function(t){var n=this;e.each(t,function(e,t){n.addButton(t)});return this},getButtons:function(){return this.options.buttons},setButtons:function(e){this.options.buttons=e;this.updateButtons();return this},getButton:function(e){if(typeof this.indexedButtons[e]!=="undefined"){return this.indexedButtons[e]}return null},getButtonSize:function(){if(typeof t.BUTTON_SIZES[this.getSize()]!=="undefined"){return t.BUTTON_SIZES[this.getSize()]}return""},updateButtons:function(){if(this.isRealized()){if(this.getButtons().length===0){this.getModalFooter().hide()}else{this.getModalFooter().find("."+this.getNamespace("footer")).html("").append(this.createFooterButtons())}}return this},isAutodestroy:function(){return this.options.autodestroy},setAutodestroy:function(e){this.options.autodestroy=e},getDescription:function(){return this.options.description},setDescription:function(e){this.options.description=e;return this},getDefaultText:function(){return t.DEFAULT_TEXTS[this.getType()]},getNamespace:function(e){return t.NAMESPACE+"-"+e},createHeaderContent:function(){var t=e("<div></div>");t.addClass(this.getNamespace("header"));t.append(this.createTitleContent());t.prepend(this.createCloseButton());return t},createTitleContent:function(){var t=e("<div></div>");t.addClass(this.getNamespace("title"));return t},createCloseButton:function(){var t=e("<div></div>");t.addClass(this.getNamespace("close-button"));var n=e('<button class="close">&times;</button>');t.append(n);t.on("click",{dialog:this},function(e){e.data.dialog.close()});return t},createBodyContent:function(){var t=e("<div></div>");t.addClass(this.getNamespace("body"));t.append(this.createMessageContent());return t},createMessageContent:function(){var t=e("<div></div>");t.addClass(this.getNamespace("message"));return t},createFooterContent:function(){var t=e("<div></div>");t.addClass(this.getNamespace("footer"));return t},createFooterButtons:function(){var n=this;var r=e("<div></div>");r.addClass(this.getNamespace("footer-buttons"));this.indexedButtons={};e.each(this.options.buttons,function(e,i){if(!i.id){i.id=t.newGuid()}var s=n.createButton(i);n.indexedButtons[i.id]=s;r.append(s)});return r},createButton:function(t){var n=e('<button class="btn"></button>');n.addClass(this.getButtonSize());n.prop("id",t.id);if(typeof t.icon!=="undefined"&&e.trim(t.icon)!==""){n.append(this.createButtonIcon(t.icon))}if(typeof t.label!=="undefined"){n.append(t.label)}if(typeof t.cssClass!=="undefined"&&e.trim(t.cssClass)!==""){n.addClass(t.cssClass)}else{n.addClass("btn-default")}if(typeof t.hotkey!=="undefined"){this.registeredButtonHotkeys[t.hotkey]=n}n.on("click",{dialog:this,$button:n,button:t},function(e){var t=e.data.dialog;var n=e.data.$button;var r=e.data.button;if(typeof r.action==="function"){r.action.call(n,t)}if(r.autospin){n.toggleSpin(true)}});this.enhanceButton(n);return n},enhanceButton:function(e){e.dialog=this;e.toggleEnable=function(e){var t=this;if(typeof e!=="undefined"){t.prop("disabled",!e).toggleClass("disabled",!e)}else{t.prop("disabled",!t.prop("disabled"))}return t};e.enable=function(){var e=this;e.toggleEnable(true);return e};e.disable=function(){var e=this;e.toggleEnable(false);return e};e.toggleSpin=function(t){var n=this;var r=n.dialog;var i=n.find("."+r.getNamespace("button-icon"));if(typeof t==="undefined"){t=!(e.find(".icon-spin").length>0)}if(t){i.hide();e.prepend(r.createButtonIcon(r.getSpinicon()).addClass("icon-spin"))}else{i.show();e.find(".icon-spin").remove()}return n};e.spin=function(){var e=this;e.toggleSpin(true);return e};e.stopSpin=function(){var e=this;e.toggleSpin(false);return e};return this},createButtonIcon:function(t){var n=e("<span></span>");n.addClass(this.getNamespace("button-icon")).addClass(t);return n},enableButtons:function(t){e.each(this.indexedButtons,function(e,n){n.toggleEnable(t)});return this},updateClosable:function(){if(this.isRealized()){this.getModalHeader().find("."+this.getNamespace("close-button")).toggle(this.isClosable())}return this},onShow:function(e){this.options.onshow=e;return this},onShown:function(e){this.options.onshown=e;return this},onHide:function(e){this.options.onhide=e;return this},onHidden:function(e){this.options.onhidden=e;return this},isRealized:function(){return this.realized},setRealized:function(e){this.realized=e;return this},isOpened:function(){return this.opened},setOpened:function(e){this.opened=e;return this},handleModalEvents:function(){this.getModal().on("show.bs.modal",{dialog:this},function(e){var t=e.data.dialog;if(typeof t.options.onshow==="function"){return t.options.onshow(t)}});this.getModal().on("shown.bs.modal",{dialog:this},function(e){var t=e.data.dialog;typeof t.options.onshown==="function"&&t.options.onshown(t)});this.getModal().on("hide.bs.modal",{dialog:this},function(e){var t=e.data.dialog;if(typeof t.options.onhide==="function"){return t.options.onhide(t)}});this.getModal().on("hidden.bs.modal",{dialog:this},function(n){var r=n.data.dialog;typeof r.options.onhidden==="function"&&r.options.onhidden(r);r.isAutodestroy()&&e(this).remove();t.moveFocus()});this.getModal().on("click",{dialog:this},function(e){e.target===this&&e.data.dialog.isClosable()&&e.data.dialog.canCloseByBackdrop()&&e.data.dialog.close()});this.getModal().on("keyup",{dialog:this},function(e){e.which===27&&e.data.dialog.isClosable()&&e.data.dialog.canCloseByKeyboard()&&e.data.dialog.close()});this.getModal().on("keyup",{dialog:this},function(t){var n=t.data.dialog;if(typeof n.registeredButtonHotkeys[t.which]!=="undefined"){var r=e(n.registeredButtonHotkeys[t.which]);!r.prop("disabled")&&r.focus().trigger("click")}});return this},makeModalDraggable:function(){if(this.options.draggable){this.getModalHeader().addClass(this.getNamespace("draggable")).on("mousedown",{dialog:this},function(e){var t=e.data.dialog;t.draggableData.isMouseDown=true;var n=t.getModalContent().offset();t.draggableData.mouseOffset={top:e.clientY-n.top,left:e.clientX-n.left}});this.getModal().on("mouseup mouseleave",{dialog:this},function(e){e.data.dialog.draggableData.isMouseDown=false});e("body").on("mousemove",{dialog:this},function(e){var t=e.data.dialog;if(!t.draggableData.isMouseDown){return}t.getModalContent().offset({top:e.clientY-t.draggableData.mouseOffset.top,left:e.clientX-t.draggableData.mouseOffset.left})})}return this},updateZIndex:function(){var n=0;e.each(t.dialogs,function(e,t){n++});var r=this.getModal();var i=r.data("bs.modal").$backdrop;r.css("z-index",t.ZINDEX_MODAL+(n-1)*20);i.css("z-index",t.ZINDEX_BACKDROP+(n-1)*10);return this},realize:function(){this.initModalStuff();this.getModal().addClass(t.NAMESPACE).addClass(this.getSize()).addClass(this.getCssClass());if(this.getDescription()){this.getModal().attr("aria-describedby",this.getDescription())}this.getModalFooter().append(this.createFooterContent());this.getModalHeader().append(this.createHeaderContent());this.getModalBody().append(this.createBodyContent());this.getModal().modal({backdrop:"static",keyboard:false,show:false});this.makeModalDraggable();this.handleModalEvents();this.setRealized(true);this.updateButtons();this.updateType();this.updateTitle();this.updateMessage();this.updateClosable();this.updateAnimate();return this},open:function(){!this.isRealized()&&this.realize();this.getModal().modal("show");this.updateZIndex();this.setOpened(true);return this},close:function(){this.getModal().modal("hide");if(this.isAutodestroy()){delete t.dialogs[this.getId()]}this.setOpened(false);t.showScrollbar();return this}};t.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,n=e==="x"?t:t&3|8;return n.toString(16)})};t.show=function(e){return(new t(e)).open()};t.alert=function(){var n={};var r={type:t.TYPE_PRIMARY,title:null,message:null,closable:true,buttonLabel:"OK",callback:null};if(typeof arguments[0]==="object"&&arguments[0].constructor==={}.constructor){n=e.extend(true,r,arguments[0])}else{n=e.extend(true,r,{message:arguments[0],closable:false,buttonLabel:"OK",callback:typeof arguments[1]!=="undefined"?arguments[1]:null})}return(new t({type:n.type,title:n.title,message:n.message,closable:n.closable,data:{callback:n.callback},onhide:function(e){!e.getData("btnClicked")&&e.isClosable()&&typeof e.getData("callback")==="function"&&e.getData("callback")(false)},buttons:[{label:n.buttonLabel,action:function(e){e.setData("btnClicked",true);typeof e.getData("callback")==="function"&&e.getData("callback")(true);e.close()}}]})).open()};t.confirm=function(e,n){return(new t({title:"Confirmation",message:e,closable:false,data:{callback:n},buttons:[{label:"Cancel",action:function(e){typeof e.getData("callback")==="function"&&e.getData("callback")(false);e.close()}},{label:"OK",cssClass:"btn-primary",action:function(e){typeof e.getData("callback")==="function"&&e.getData("callback")(true);e.close()}}]})).open()};t.warning=function(e,n){return(new t({type:t.TYPE_WARNING,message:e})).open()};t.danger=function(e,n){return(new t({type:t.TYPE_DANGER,message:e})).open()};t.success=function(e,n){return(new t({type:t.TYPE_SUCCESS,message:e})).open()};return t})